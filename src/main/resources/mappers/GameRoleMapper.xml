<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.ssm.promotion.core.dao.GameRoleDao">
    <resultMap type="GameRole" id="GameRoleResult">
        <result property="id" column="id"/>
        <result property="accountId" column="accountId"/>
        <result property="roleId" column="roleId"/>
        <result property="channelId" column="channelId"/>
        <result property="gameId" column="gameId"/>
        <result property="serverId" column="serverId"/>
        <result property="createTime" column="createTime"/>
        <result property="lastLoginTime" column="lastLoginTime"/>
        <result property="name" column="name"/>
        <result property="balance" column="balance"/>
        <result property="param" column="param"/>

    </resultMap>
    <insert id="create" parameterType="GameRole">
        insert into
        zy_role(accountId,roleId,channelId,gameId,serverId,createTime,lastLoginTime,name,balance,param)
        values(#{accountId},#{roleId},#{channelId},#{gameId},#{serverId},#{createTime},#{lastLoginTime},#{name},#{balance},#{param})
    </insert>
    <update id="updateGameRole" parameterType="map">
        update zy_role
        <set>
            <if test="lastLoginTime!=null and lastLoginTime!='' ">
                lastLoginTime=#{lastLoginTime},
            </if>
            <if test="name!=null and name!=''  ">
                param=#{name},
            </if>
            <if test="balance!=null and balance!=''  ">
                param=#{balance},
            </if>
            <if test="param!=null and param!=''  ">
                param=#{param},
            </if>
        </set>
        <where>
            <if test="roleId!=null and roleId!=''">
                and channelId=#{roleId}
            </if>
            <if test="gameId!=null and gameId!=''">
                and channelId=#{gameId}
            </if>
            <if test="serverId!=null and serverId!=''">
                and channelId=#{serverId}
            </if>
        </where>
    </update>
    <!--

        <select id="findUsers" parameterType="Map" resultMap="UserResult">
            select id,user_name,password,role_name,func,manager_lv,spId,agents from ssm_user
            <where>
                <if test="userName!=null and userName!='' ">
                    AND user_name like "%#{userName}%"
                </if>
            </where>
            <choose>
                &lt;!&ndash;        查自己    &ndash;&gt;
                <when test="managerLv == null || managerLv =='' || managerLv == 100 ||managerLv == 0 || self == 0">
                    AND id=#{currUserId}
                </when>
                &lt;!&ndash;      查渠道      &ndash;&gt;
                <when test="managerLv==500 and self == 1">
                    AND agents=#{agents}
                </when>
            </choose>
            <if test="start!=null and size!=null">
                limit #{start},#{size}
            </if>
        </select>

        <select id="getTotalUser" parameterType="Map" resultType="Long">
            select count(*) from ssm_user
            <where>
                <if test="userName!=null and userName!='' ">
                    AND user_name like #{userName}
                </if>
            </where>
        </select>

        <insert id="addUser" parameterType="User">
            insert into ssm_user(user_name,password,role_name,func,manager_lv,spId,agents)
            values(#{userName},#{password},#{roleName},#{func},#{managerLv},#{spId},#{agents})
        </insert>

        <update id="updateUser" parameterType="User">
            update ssm_user
            <set>
                <if test="userName!=null and userName!=''">
                    user_name=#{userName},
                </if>
                <if test="password!=null and password!='' ">
                    password=#{password},
                </if>
                <if test="roleName!=null and roleName!=''  ">
                    role_name=#{roleName},
                </if>
                <if test="func!=null and func!='' ">
                    func=#{func},
                </if>
                <if test="managerLv!=null  ">
                    manager_lv=#{managerLv},
                </if>
                <if test="spId!=null and spId!='' ">
                    spId=#{spId},
                </if>
                <if test="agents!=null and agents!='' ">
                    agents=#{agents}
                </if>
            </set>
            where id=#{id}
        </update>

        <delete id="deleteUser" parameterType="Integer">
            delete from ssm_user
            where id=#{id}
        </delete>
        <select id="getTotalSameUser" parameterType="Map" resultType="long">
            select count(*) from ssm_user
            <where>
                <if test="userName!=null and userName!='' ">
                    AND user_name=#{userName}
                </if>
            </where>
        </select>-->
</mapper> 